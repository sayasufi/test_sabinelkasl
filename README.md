# Cash Register System

Этот проект представляет собой систему кассового учета с возможностью генерации чеков в формате PDF, отображением QR-кодов и интеграцией с Nginx для обслуживания медиафайлов.

## Основные функции

- **Генерация чеков**: Генерация чека с подробной информацией о товарах, их количестве и общей сумме. Чек сохраняется в формате PDF.
- **Генерация QR-кода**: Создание QR-кода, ссылающегося на сгенерированный PDF-файл чека.
- **Просмотр списка доступных товаров**: API для получения списка всех доступных товаров с их ID и наименованием.
- **Масштабируемость**: Поддержка контейнеризации с использованием Docker и оркестрацией через Docker Compose.

## Структура проекта

- **`cash_register/`**: Основная директория проекта Django.
  - **`settings.py`**: Настройки Django.
  - **`urls.py`**: Маршрутизация URL.
  - **`wsgi.py`**: Точка входа для WSGI сервера.
- **`shop/`**: Приложение для работы с товарами и чеками.
  - **`models.py`**: Модели базы данных.
  - **`views.py`**: Обработчики запросов.
  - **`serializers.py`**: Сериализация данных для API.
  - **`populate_items.py`**: Скрипт для заполнения базы данных случайными товарами.
  - **`templates/`**: HTML-шаблоны для генерации PDF.
- **`media/`**: Директория для хранения сгенерированных чеков и QR-кодов.
- **`static/`**: Директория для статических файлов (CSS, JS).
- **`Dockerfile`**: Dockerfile для создания образа приложения.
- **`docker-compose.yml`**: Файл для запуска Docker Compose.
- **`requirements.txt`**: Список зависимостей Python.

## Установка и настройка

### Предварительные требования

- Docker и Docker Compose должны быть установлены на вашей машине.
- Подключение к сети для доступа к образам Docker и возможности тестирования через локальную сеть.

### Шаги по установке

1. **Клонирование репозитория:**
    ```bash
    git clone https://github.com/ваш-репозиторий.git
    cd ваш-репозиторий
    ```

2. **Запуск Docker Compose:**
    ```bash
    docker-compose up --build
    ```
    Эта команда собирает и запускает контейнеры для веб-приложения, базы данных PostgreSQL и Nginx.

3. **Доступ к приложению:**
    - Веб-приложение будет доступно по адресу: `http://<ваш-IP>:8000`
    - Nginx будет доступен по адресу: `http://<ваш-IP>:80`
    - Для получения IP-адреса выполните команду `ifconfig` (на Linux или macOS) или `ipconfig` (на Windows) и найдите ваш локальный IP.
   - В проекте у вас уже есть конфигурационный файл для Nginx, например `nginx/default.conf`. Откройте его для редактирования и укажите свой IP-адрес

4. **Тестирование через смартфон:**
    - Убедитесь, что ваше устройство подключено к той же сети, что и ваш сервер.
    - Используйте IP-адрес вашей машины для доступа к веб-приложению через браузер на смартфоне.

### Примеры запросов

1. **Генерация чека:**
    - **URL**: `/cash_machine/`
    - **Метод**: `POST`
    - **Тело запроса**:
      ```json
      {
          "items": [1, 2, 3]
      }
      ```
    - **Ответ**:
      ```json
      {
          "pdf_url": "/media/receipt_20240815113030.pdf",
          "qr_code_url": "/media/qr_20240815113030.png"
      }
      ```

2. **Получение списка товаров:**
    - **URL**: `/items/`
    - **Метод**: `GET`
    - **Ответ**:
      ```json
      [
          {"id": 1, "title": "Сок"},
          {"id": 2, "title": "Пицца"},
          {"id": 3, "title": "Чай"},
          ...
      ]
      ```

### Дополнительные настройки

1. **ALLOWED_HOSTS**:
   В файле `settings.py` в **ALLOWED_HOSTS** добавьте `'*'`, чтобы разрешить доступ к приложению с любых хостов.

2. **Перезаполнение базы данных**:
   Для перезаполнения базы данных случайными товарами при каждом запуске установите переменную `POPULATE_DB` в `docker-compose.yml`:
   ```yaml
   environment:
     POPULATE_DB: "True"